local a;do local unpack,b,c,d,e,f,g,h,i,j,k=table.unpack or unpack,table.concat,string.byte,string.char,string.rep,string.sub,string.format,math.floor,math.ceil,math.min,math.max;shared.unpack=unpack;local l,m,n,o,p,q,r,s;local function o(t,u)return t*2^u%4294967296 end;local function p(t,u)t=t%4294967296/2^u;return t-t%1 end;local function q(t,u)t=t%4294967296*2^u;local v=t%4294967296;return v+(t-v)/4294967296 end;local function r(t,u)t=t%4294967296/2^u;local v=t%1;return v*4294967296+t-v end;local w={}for x=0,65535 do local t=x%256;local y=(x-t)/256;local z=0;local A=1;while t*y~=0 do local B=t%2;local C=y%2;z=z+B*C*A;t=(t-B)/2;y=(y-C)/2;A=A*2 end;w[x]=z end;local function D(t,y,E)local F=t%4294967296;local G=y%4294967296;local B=F%256;local C=G%256;local z=w[B+C*256]t=F-B;y=(G-C)/256;B=t%65536;C=y%256;z=z+w[B+C]*256;t=(t-B)/256;y=(y-C)/256;B=t%65536+y%256;z=z+w[B]*65536;z=z+w[(t+y-B)/256]*16777216;if E then z=F+G-E*z end;return z end;local function l(t,y)return D(t,y)end;local function m(t,y)return D(t,y,1)end;local function n(t,y,H)if H then y=D(y,H,2)end;return D(t,y,2)end;local function s(t)return g("%08x",t%4294967296)end;local I,J,K,L={},{},{},{}local M={[224]={},[256]=L}local N,O={[384]={},[512]=K},{[384]={},[512]=L}local P={}local function Q(R,S,T,U,V,W)for X=V,W+V-1,64 do for Y=1,16 do X=X+4;local Z,_,a0,a1=c(T,X-3,X)U[Y]=((Z*256+_)*256+a0)*256+a1 end;for Y=17,64 do local Z,_=U[Y-15],U[Y-2]U[Y]=n(r(Z,7),q(Z,14),p(Z,3))+n(q(_,15),q(_,13),p(_,10))+U[Y-7]+U[Y-16]end;local Z,_,a0,a1,a2,a3,a4,a5,H=R[1],R[2],R[3],R[4],R[5],R[6],R[7],R[8]for Y=1,64 do H=n(r(a2,6),r(a2,11),q(a2,7))+l(a2,a3)+l(-1-a2,a4)+a5+S[Y]+U[Y]a5=a4;a4=a3;a3=a2;a2=H+a1;a1=a0;a0=_;_=Z;Z=H+l(a1,a0)+l(Z,n(a1,a0))+n(r(Z,2),r(Z,13),q(Z,10))end;R[1],R[2],R[3],R[4]=(Z+R[1])%4294967296,(_+R[2])%4294967296,(a0+R[3])%4294967296,(a1+R[4])%4294967296;R[5],R[6],R[7],R[8]=(a2+R[5])%4294967296,(a3+R[6])%4294967296,(a4+R[7])%4294967296,(a5+R[8])%4294967296 end end;local function a6(a7,a8,a9,aa,T,U,V,W)for X=V,W+V-1,128 do for Y=1,32 do X=X+4;local Z,_,a0,a1=c(T,X-3,X)U[Y]=((Z*256+_)*256+a0)*256+a1 end;local ab,ac;for ad=17*2,80*2,2 do local ae,af,ag,ah=U[ad-30],U[ad-31],U[ad-4],U[ad-5]ab=n(p(ae,1)+o(af,31),p(ae,8)+o(af,24),p(ae,7)+o(af,25))+n(p(ag,19)+o(ah,13),o(ag,3)+p(ah,29),p(ag,6)+o(ah,26))+U[ad-14]+U[ad-32]ac=ab%4294967296;U[ad-1]=n(p(af,1)+o(ae,31),p(af,8)+o(ae,24),p(af,7))+n(p(ah,19)+o(ag,13),o(ah,3)+p(ag,29),p(ah,6))+U[ad-15]+U[ad-33]+(ab-ac)/4294967296;U[ad]=ac end;local ae,ag,ai,aj,ak,al,am,an,ao=a7[1],a7[2],a7[3],a7[4],a7[5],a7[6],a7[7],a7[8]local af,ah,ap,aq,ar,as,at,au,av=a8[1],a8[2],a8[3],a8[4],a8[5],a8[6],a8[7],a8[8]for Y=1,80 do local ad=2*Y;ab=n(p(ak,14)+o(ar,18),p(ak,18)+o(ar,14),o(ak,23)+p(ar,9))+l(ak,al)+l(-1-ak,am)+an+a9[Y]+U[ad]ao=ab%4294967296;av=n(p(ar,14)+o(ak,18),p(ar,18)+o(ak,14),o(ar,23)+p(ak,9))+l(ar,as)+l(-1-ar,at)+au+aa[Y]+U[ad-1]+(ab-ao)/4294967296;an=am;au=at;am=al;at=as;al=ak;as=ar;ab=ao+aj;ak=ab%4294967296;ar=av+aq+(ab-ak)/4294967296;aj=ai;aq=ap;ai=ag;ap=ah;ag=ae;ah=af;ab=ao+l(aj,ai)+l(ag,n(aj,ai))+n(p(ag,28)+o(ah,4),o(ag,30)+p(ah,2),o(ag,25)+p(ah,7))ae=ab%4294967296;af=av+l(aq,ap)+l(ah,n(aq,ap))+n(p(ah,28)+o(ag,4),o(ah,30)+p(ag,2),o(ah,25)+p(ag,7))+(ab-ae)/4294967296 end;ab=a7[1]+ae;ac=ab%4294967296;a7[1],a8[1]=ac,(a8[1]+af+(ab-ac)/4294967296)%4294967296;ab=a7[2]+ag;ac=ab%4294967296;a7[2],a8[2]=ac,(a8[2]+ah+(ab-ac)/4294967296)%4294967296;ab=a7[3]+ai;ac=ab%4294967296;a7[3],a8[3]=ac,(a8[3]+ap+(ab-ac)/4294967296)%4294967296;ab=a7[4]+aj;ac=ab%4294967296;a7[4],a8[4]=ac,(a8[4]+aq+(ab-ac)/4294967296)%4294967296;ab=a7[5]+ak;ac=ab%4294967296;a7[5],a8[5]=ac,(a8[5]+ar+(ab-ac)/4294967296)%4294967296;ab=a7[6]+al;ac=ab%4294967296;a7[6],a8[6]=ac,(a8[6]+as+(ab-ac)/4294967296)%4294967296;ab=a7[7]+am;ac=ab%4294967296;a7[7],a8[7]=ac,(a8[7]+at+(ab-ac)/4294967296)%4294967296;ab=a7[8]+an;ac=ab%4294967296;a7[8],a8[8]=ac,(a8[8]+au+(ab-ac)/4294967296)%4294967296 end end;do local function aw(ax,ay,az,aA)local aB={}local aC=0;local aD=0.0;local aE=1.0;for Y=1,aA do local aF=0;for aG=k(1,Y+1-#ay),j(Y,#ax)do aF=aF+ax[aG]*ay[Y+1-aG]end;aC=aC+aF*az;local aH=aC%16777216;aB[Y]=aH;aC=h(aC/16777216)aD=aD+aH*aE;aE=aE*2^24 end;return aB,aD end;local x,aI,aJ,aK=0,{4,1,2,-2,2},4,{1}local aL,aM,aN=L,K,0;repeat aJ=aJ+aI[aJ%6]local a1=1;repeat a1=a1+aI[a1%6]if a1*a1>aJ then x=x+1;local aO=aJ^(1/3)local aP=aw({h(aO*2^40)},aK,1,2)local aQ,aR=aw(aP,aw(aP,aP,1,4),-1,4)local aS=aP[2]%65536*65536+h(aP[1]/256)local aT=aP[1]%256*16777216+h(aR*2^-56/3*aO/aJ)J[x],I[x]=aS,aT;if x<17 then aO=aJ^(1/2)aP=aw({h(aO*2^40)},aK,1,2)aQ,aR=aw(aP,aP,-1,2)aS=aP[2]%65536*65536+h(aP[1]/256)aT=aP[1]%256*16777216+h(aR*2^-17/aO)M[224][x+aN]=aT;aL[x+aN],aM[x+aN]=aS,aT;if x==8 then aL,aM,aN=O[384],N[384],-8 end end;break end until aJ%a1==0 until x>79 end;for aU=224,256,32 do local a7,a8={},{}for Y=1,8 do a7[Y]=n(K[Y],0xa5a5a5a5)a8[Y]=n(L[Y],0xa5a5a5a5)end;a6(a7,a8,I,J,"SHA-512/"..tonumber(aU).."\128"..e("\0",115).."\88",P,0,128)N[aU]=a7;O[aU]=a8 end;local function aV(aU,aW)local aX,aY,a7,a8=0,"",{unpack(N[aU])},{unpack(O[aU])}local function aZ(a_)if a_ then if aY then aX=aX+#a_;local V=0;if aY~=""and#aY+#a_>=128 then V=128-#aY;a6(a7,a8,I,J,aY..f(a_,1,V),P,0,128)aY=""end;local W=#a_-V;local b0=W%128;a6(a7,a8,I,J,a_,P,V,W-b0)aY=aY..f(a_,#a_+1-b0)return aZ else error("Adding more chunks is not allowed after asking for final result",2)end else if aY then local b1={aY,"\128",e("\0",(-17-aX)%128+9)}aY=nil;aX=aX*8/256^7;for Y=4,10 do aX=aX%1*256;b1[Y]=d(h(aX))end;b1=b(b1)a6(a7,a8,I,J,b1,P,0,#b1)local b2=i(aU/64)for Y=1,b2 do a7[Y]=s(a8[Y])..s(a7[Y])end;a8=nil;a7=b(a7,"",1,b2):sub(1,aU/4)end;return a7 end end;if aW then return aZ(aW)()else return aZ end end;function a(b3,b4)return aV(512,b3 ..b4 ..b3)end end;return a
